<!DOCTYPE html>
<html>
    <head>
        <link href="https://surveyjs.azureedge.net/1.8.4/survey.css" type="text/css" rel="stylesheet" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.10/vue.min.js"></script>
        <script src="https://surveyjs.azureedge.net/1.8.4/survey.vue.min.js"></script>
        <script src="./js/cspro.reader.js"></script>
        <script src="./js/cspro.model.js"></script>
        <script src="./js/cspro.json.js"></script>
        <link href="https://unpkg.com/survey-core@1.8.64/modern.min.css" type="text/css" rel="stylesheet"/>
    </head>
    <body>
        <div id="surveyContainer"><survey :survey="survey"></survey></div>
        <div id="surveyResult"></div>
    </body>
    <script type="text/javascript">

    var dictionary = `[Dictionary]
Version=CSPro 7.6
Label=testApp
Name=TESTAPP_DICT
RecordTypeStart=1
RecordTypeLen=1
Positions=Relative
ZeroFill=No
DecimalChar=Yes
SecurityOptions=9934C97A920A2B35EFF8C82B8B866E773958CB72C14B1418A77AA2AEB8240E37

[Level]
Label=testApp Level
Name=TESTAPP_LEVEL

[IdItems]

[Item]
Label=ID Application
Name=TESTAPP_ID
Start=2
Len=5

[Record]
Label=Infos Parcelles
Name=TESTAPP_REC
RecordTypeValue='1'
MaxRecords=5
RecordLen=56

[Item]
Label=Numero Parcelle
Name=NUMERO_PARCELLE
Start=7
Len=1

[Item]
Label=Localisation Parcelle
Name=LIEU
Start=8
Len=20
DataType=Alpha

[Item]
Label=Tenure Parcelle
Name=TENURE_PARCELLE
Start=28
Len=1

[ValueSet]
Label=Tenure Parcelle
Name=TENURE_PARCELLE_VS1
Value=1;Proprietaire
Value=2;Metayer
Value=3;Heritage
Value=4;Usurfruit

[Item]
Label=Arbres fruitiers present sur parcelle
Name=ARBRES_FRUITIETS_PRESENT_SUR_PARCELLE
Start=29
Len=28
DataType=Alpha

[ValueSet]
Label=Arbres fruitiers present sur parcelle
Name=ARBRES_FRUITIETS_PRESENT_SUR_PARCELLE_VS1
Value='01                          ';Manguier
Value='02                          ';Avocatier
Value='03                          ';Oranger
Value='04                          ';Cerisier
Value='05                          ';Amandier
Value='06                          ';Citronnier
Value='07                          ';Mandarinier
Value='08                          ';Tamarinier
Value='09                          ';Goyavier
Value='10                          ';Papayer
Value='11                          ';Anacadier
Value='12                          ';Pamplemoussier
Value='13                          ';Cocotier
Value='14                          ';Bigaradier

[Record]
Label=Details Arbres
Name=DETAILS_ARBRES
RecordTypeValue='2'
MaxRecords=60
RecordLen=74

[Item]
Label=Code Arbre
Name=CODE_ARBRE
Start=7
Len=18
DataType=Alpha

[Item]
Label=Nom Arbre
Name=NOM_ARBRE
Start=25
Len=20
DataType=Alpha

[Item]
Label=Variete arbre
Name=VARIETE_ARBRE
Start=45
Len=20
DataType=Alpha

[Item]
Label=Nombre Arbre
Name=NOMBRE_ARBRE
Start=65
Len=2

[Item]
Label=Date de Plantation
Name=DATE_DE_PLANTATION
Start=67
Len=8
`;


Survey
    .StylesManager
    .applyTheme("modern");

function getSurvey(dct, survey) {
    var csproJson = CSPro2Json.transform(dct);
    //console.log(csproJson);
    CSProJson2SurveyJson.transform(csproJson, survey);
    //console.log(survey);
};

var survey = new Survey.Model();
getSurvey(dictionary, survey);


function sendDataToServer(survey) {
    //send Ajax request to your web serverr
    alert("The results are:" + JSON.stringify(survey.data));
    document
            .querySelector('#surveyResult')
            .textContent = "Result JSON:\n" + JSON.stringify(survey.data, null, 3);
};

//var survey = new Survey.Model(surveyJSON);
survey
    .onComplete
    .add(sendDataToServer);
new Vue({ el: '#surveyContainer', data: { survey: survey } });

    </script>
</html>